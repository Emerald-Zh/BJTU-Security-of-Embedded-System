# Security-of-Embedded-System
BJTU 嵌入式系统安全结课大作业
### 作业题目：带有安全认证机制的钱包交易
实验内容：
 1. 要求钱包交易具有内、外部认证功能   
 2. 要求钱包需对加减钱的数据进行MAC校验。
 3. 编写JCOP脚本对编写的Applet进行测试。

### 说明
在该电子钱包应用中， Purse 负责处理用户的存款、消费请求，并调用积分应用 JavaLoyalty 进行积分管理。CyclicFile 类用于存储交易记录，JavaLoyaltyInterface 接口定义了电子钱包和积分应用之间的通信方式。

### 测试脚本
1.选择钱包应用程序 /select 112233445503：确保应用程序能够正确被选择。

2.验证PIN：/send 8020000006010203040506 ：

3.获取随机数/send 8080000000，返回DATA：A8 DC 24 D9 3A BF 97 95 90 00，其中的A8 DC 24 D9 3A BF 97 95为生成的随机数，将随机数通过des中的ecb方法加密，秘钥为0102030405060708，可以获得对应的加密结果。

4.外部认证：/send 8082000008C091E93BBAE9891A，添加上面的加密结果后进行认证

5.内部认证，返回加密值/send 8084000008192450D0AE2D5F7F

6.加钱0x64的MAC认证：/send 80700000086430112233445503，获得返回随机数37 A2 B2 00 5B 3C DF F6

7. 减钱0x32的MAC认证：/send 80700000083240112233445503，获得随机数0B CC F5 C7 58 5A 2D EA

8.加钱0x64：/send 80300000096437A2B2005B3CDFF6

9.查余额：/send 8050000002，返回值为0094

10.减钱0x32：/send 8040000009320BCCF5C7585A2DEA

11.查余额：/send 8050000002，返回值为0032
